package kitpvp;

import java.util.Arrays;

import org.bukkit.Bukkit;
import org.bukkit.Material;
import org.bukkit.command.Command;
import org.bukkit.command.CommandExecutor;
import org.bukkit.command.CommandSender;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.inventory.InventoryClickEvent;
import org.bukkit.inventory.Inventory;
import org.bukkit.inventory.ItemStack;

import kitpvp.Util.ChatUtils;
import kitpvp.Util.KitAPI;

public class Settings implements CommandExecutor, Listener {

	private FileConfiguration data = Main.getDataFile();
	
	@Override
	public boolean onCommand(CommandSender sender, Command cmd, String label, String[] args) {
		
		if(label.equalsIgnoreCase("settings") || label.equalsIgnoreCase("asetukset")){
			
			if(!(sender instanceof Player)) return true;
			
			openSettingsGUI((Player) sender);
			
		}
		
		return true;
	}
	
	@EventHandler
	public void onInvClick(InventoryClickEvent e){
		
		Player p = (Player) e.getWhoClicked();
		ItemStack item = e.getCurrentItem();
		Inventory inv = e.getInventory();
		String uuid = p.getUniqueId().toString();
		
		if(item == null || item.getType() == Material.AIR) return;
		
		if(inv.getName().equals("Asetukset") || inv.getName().equals("Settings")){
			
			e.setCancelled(true);
			
			if(item.getType() == Material.BOOK_AND_QUILL && (data.getBoolean(uuid + ".chatMention"))){
				data.set(uuid + ".chatMention", false);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Chat-maininnat ovat nyt ßcpois p‰‰lt‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Chat mentions are now ßcoffß7!");
				}
			}
			else if(item.getType() == Material.BOOK_AND_QUILL && !(data.getBoolean(uuid + ".chatMention"))){
				data.set(uuid + ".chatMention", true);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Chat-maininnat ovat nyt ßap‰‰ll‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Chat mentions are now ßaonß7!");
				}
			}
			else if(item.getType() == Material.PAPER && (data.getBoolean(uuid + ".scoreboard"))){
				data.set(uuid + ".scoreboard", false);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Scoreboard on nyt ßcpois p‰‰lt‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Scroreboard is now ßcoffß7!");
				}
			}
			else if(item.getType() == Material.PAPER && !(data.getBoolean(uuid + ".scoreboard"))){
				data.set(uuid + ".scoreboard", true);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Scoreboard on nyt ßap‰‰ll‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Scoreboard is now ßaonß7!");
				}
				Main.getAPI().giveScoreboard(p);
			}
			else if (item.getType() == Material.REDSTONE && item.hasItemMeta()){
				if(!p.hasPermission("settings.yt")){
					p.closeInventory();
					ChatUtils.sendPermissionMessageYT(p);
				}
				else{
					openSettingsYTGUI(p);
				}
			}
			else if (item.getType() == Material.GOLD_INGOT && item.hasItemMeta()){
				if(!p.hasPermission("settings.vip")){
					p.closeInventory();
					ChatUtils.sendPermissionMessageBooster(p);
				}
				else{
					openSettingsVIPGUI(p);
				}
			}
			
		}
		else if (inv.getName().equals("YT-Asetukset") || inv.getName().equals("YT-Settings")){
			
			e.setCancelled(true);
			
			if(item.getType() == Material.ARROW){
				openSettingsGUI(p);
			}
			 if(item.getType() == Material.PAPER && data.getBoolean(uuid + ".chat")){
				data.set(uuid + ".chat", false);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Chat on nyt ßcpois p‰‰lt‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Chat is now ßcoffß7!");
				}
			}
			else if(item.getType() == Material.PAPER && !data.getBoolean(uuid + ".chat")){
				data.set(uuid + ".chat", true);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Chat on nyt ßap‰‰ll‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Chat is now ßaonß7!");
				}
			}
			else if(item.getType() == Material.MAP && data.getBoolean(uuid + ".privateMsg")){
				data.set(uuid + ".privateMsg", false);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Yksityisviestit ovat nyt ßcpois p‰‰lt‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Private messages are now ßcoffß7!");
				}
			}
			else if(item.getType() == Material.MAP && !data.getBoolean(uuid + ".privateMsg")){
				data.set(uuid + ".privateMsg", true);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Yksityisviestit ovat nyt ßap‰‰ll‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Private messages are now ßaonß7!");
				}
			}
			else if(item.getType() == Material.NETHER_STAR && data.getBoolean(uuid + ".privateAccount")){
				data.set(uuid + ".privateAccount", false);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Yksityisyys on nyt ßcpois p‰‰lt‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Private account is now ßcoffß7!");
				}
			}
			else if(item.getType() == Material.NETHER_STAR && !data.getBoolean(uuid + ".privateAccount")){
				data.set(uuid + ".privateAccount", true);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Yksityisyys on nyt ßap‰‰ll‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Private account is now ßaonß7!");
				}
			}
			
		}
		else if (inv.getName().equals("VIP-Asetukset") || inv.getName().equals("VIP-Settings")){
			
			e.setCancelled(true);
			
			if(item.getType() == Material.ARROW){
				openSettingsGUI(p);
			}
			
			else if(item.getType() == Material.MAP && data.getBoolean(uuid + ".privateMsg")){
				data.set(uuid + ".privateMsg", false);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Yksityisviestit ovat nyt ßcpois p‰‰lt‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Private messages are now ßcoffß7!");
				}
			}
			else if(item.getType() == Material.MAP && !data.getBoolean(uuid + ".privateMsg")){
				data.set(uuid + ".privateMsg", true);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Yksityisviestit ovat nyt ßap‰‰ll‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Private messages are now ßaonß7!");
				}
			}
			else if(item.getType() == Material.NETHER_STAR && data.getBoolean(uuid + ".privateAccount")){
				data.set(uuid + ".privateAccount", false);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Yksityisyys on nyt ßcpois p‰‰lt‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Private account is now ßcoffß7!");
				}
			}
			else if(item.getType() == Material.NETHER_STAR && !data.getBoolean(uuid + ".privateAccount")){
				data.set(uuid + ".privateAccount", true);
				p.closeInventory();
				Main.saveDataFile();
				if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Yksityisyys on nyt ßap‰‰ll‰ß7!");
				} else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
					ChatUtils.sendMessageWithPrefix(p, "ß7Private account is now ßaonß7!");
				}
			}
			
		}
		
	}
	
	public void openSettingsGUI(Player p){
		
		String uuid = p.getUniqueId().toString();
		KitAPI api = Main.getAPI();
		
		if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
			
			Inventory inv = Bukkit.createInventory(null, 36, "Asetukset");
			
			if (data.getBoolean(uuid + ".chatMention")) {
				api.createItem(inv, 10, Material.BOOK_AND_QUILL, 1, "ßbßlChat-maininnat", Arrays.asList("ß7Jos t‰m‰ on pois p‰‰lt‰, et", "ß7saa ilmoitusta kun sinut mainitaan",
						"ß7chatissa!", "", "ß7Tila: ßaßlK‰ytˆss‰"));
			} else if (!data.getBoolean(uuid + ".chatMention")) {
				api.createItem(inv, 10, Material.BOOK_AND_QUILL, 1, "ßbßlChat-maininnat", Arrays.asList("ß7Jos t‰m‰ on pois p‰‰lt‰, et", "ß7saa ilmoitusta kun sinut mainitaan",
						"ß7chatissa!", "", "ß7Tila: ßcßlEi k‰ytˆss‰"));
			}
			 if (data.getBoolean(uuid + ".scoreboard")) {
				api.createItem(inv, 12, Material.PAPER, 1, "ßbßlScoreboard", Arrays.asList("ß7Jos t‰m‰ on pois p‰‰lt‰, et", "ß7n‰‰ scoreboardia n‰ytˆn sivulla!",
						"", "ß7Tila: ßaßlK‰ytˆss‰"));
			} else if (!data.getBoolean(uuid + ".scoreboard")) {
				api.createItem(inv, 12, Material.PAPER, 1, "ßbßlScoreboard", Arrays.asList("ß7Jos t‰m‰ on pois p‰‰lt‰, et", "ß7n‰‰ scoreboardia n‰ytˆn sivulla!",
						"", "ß7Tila: ßcßlEi k‰ytˆss‰"));
			}
			
			api.createItem(inv, 34, Material.GOLD_INGOT, 1, "ß6ßlVIP-Asetukset", Arrays.asList("ß7Klikkaa p‰‰st‰ksesi ß6VIP-", "ß6asetuksiinß7!"));
			api.createItem(inv, 35, Material.REDSTONE, 1, "ßcßlYT-Asetukset", Arrays.asList("ß7Klikkaa p‰‰st‰kesi ßcYT-", "ßcasetuksiinß7!"));
			
			p.openInventory(inv);
		}
		else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
			
			Inventory inv = Bukkit.createInventory(null, 36, "Settings");
			
			if (data.getBoolean(uuid + ".chatMention")) {
				api.createItem(inv, 10, Material.BOOK_AND_QUILL, 1, "ßbßlChat mentions", Arrays.asList("ß7If this is not in use, you", "ß7wont get notified when you get",
						"ß7mentioned in the chat.", "", "ß7State: ßaßlUsing"));
			} else if (!data.getBoolean(uuid + ".chatMention")) {
				api.createItem(inv, 10, Material.BOOK_AND_QUILL, 1, "ßbßlChat mentions", Arrays.asList("ß7If this is not in use, you", "ß7wont get notified when you get",
						"ß7mentioned in the chat.", "", "ß7State: ßcßlNot using"));
			}
			 if (data.getBoolean(uuid + ".scoreboard")) {
				api.createItem(inv, 12, Material.PAPER, 1, "ßbßlScoreboard", Arrays.asList("ß7If this is not in use, you", "ß7wont see the scoreboard at the right", "ß7side of your screen.",
						"", "ß7State: ßaßlUsing"));
			} else if (!data.getBoolean(uuid + ".scoreboard")) {
				api.createItem(inv, 12, Material.PAPER, 1, "ßbßlScoreboard", Arrays.asList("ß7If this is not in use, you", "ß7wont see the scoreboard at the right", "ß7side of your screen.",
						"", "ß7State: ßcßlNot using"));
			}
			
			api.createItem(inv, 34, Material.GOLD_INGOT, 1, "ß6ßlVIP-Settings", Arrays.asList("ß7Click to go to the", "ß6VIP-Settingsß7!"));
			api.createItem(inv, 35, Material.REDSTONE, 1, "ßcßlYT-Settings", Arrays.asList("ß7Click to go to the ", "ßcYT-Settingsß7!"));

			p.openInventory(inv);
		}
		
	}

	public void openSettingsYTGUI(Player p){
		
		String uuid = p.getUniqueId().toString();
		KitAPI api = Main.getAPI();
		
		if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
			
			Inventory inv = Bukkit.createInventory(null, 36, "YT-Asetukset");
			
			if (data.getBoolean(uuid + ".chat")) {
				api.createItem(inv, 10, Material.PAPER, 1, "ßbßlChat", Arrays.asList("ß7Jos t‰m‰ on k‰ytˆss‰, ", "ß7et saa tulevia viestej‰ chattiin.", "", "ß7Tila: ßaßlK‰ytˆss‰"));
			} else if (!data.getBoolean(uuid + ".chat")) {
				api.createItem(inv, 10, Material.PAPER, 1, "ßbßlChat", Arrays.asList("ß7Jos t‰m‰ on k‰ytˆss‰, ", "ß7et saa tulevia viestej‰ chattiin.",
						"", "ß7Tila: ßcßlEi k‰ytˆss‰"));
			}
			 if (data.getBoolean(uuid + ".privateMsg")) {
				api.createItem(inv, 12, Material.MAP, 1, "ßbßlYksityisviestit", Arrays.asList("ß7Jos t‰m‰ on p‰‰ll‰, et", "ß7saa tulevia yksityisviestej‰!",
						"", "ß7Tila: ßaßlK‰ytˆss‰"));
			} else if (!data.getBoolean(uuid + ".privateMsg")) {
				api.createItem(inv, 12, Material.MAP, 1, "ßbßlYksityisviestit", Arrays.asList("ß7Jos t‰m‰ on p‰‰ll‰, et", "ß7saa tulevia yksityisviestej‰!",
						"", "ß7Tila: ßcßlEi k‰ytˆss‰"));
			}
			 if (data.getBoolean(uuid + ".privateAccount")) {
				api.createItem(inv, 14, Material.NETHER_STAR, 1, "ßbßlYksityinen", Arrays.asList("ß7Jos t‰m‰ on p‰‰ll‰ k‰ytt‰j‰si on", "ß7yksityinen, eik‰ kukaan", 
						"ß7voi n‰hd‰ statsejasi tai profiiliasi", "", "ß7Tila: ßaßlK‰ytˆss‰"));
			} else if (!data.getBoolean(uuid + ".privateAccount")) {
				api.createItem(inv, 14, Material.NETHER_STAR, 1, "ßbßlYksityinen", Arrays.asList("ß7Jos t‰m‰ on p‰‰ll‰ k‰ytt‰j‰si on", "ß7yksityinen, eik‰ kukaan", 
						"ß7voi n‰hd‰ statsejasi tai profiiliasi", "", "ß7Tila: ßcßlEi k‰ytˆss‰"));
			}
			
			api.createItem(inv, 27, Material.ARROW, 1, "ßaTavalliset asetukset", Arrays.asList("ß7Klikkaa p‰‰st‰ksesi takaisin", "ß7tavallisiin asetuksiin!"));
			
			p.openInventory(inv);
		}
		else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
			
			Inventory inv = Bukkit.createInventory(null, 36, "YT-Settings");
			
			if (data.getBoolean(uuid + ".chat")) {
				api.createItem(inv, 10, Material.PAPER, 1, "ßbßlChat", Arrays.asList("ß7If this is in use you wont ", "recieve chat messages.", "", "ß7State: ßaßlUsing"));
			} else if (!data.getBoolean(uuid + ".chat")) {
				api.createItem(inv, 10, Material.PAPER, 1, "ßbßlChat", Arrays.asList("ß7If this is in use", "ß7you wont receive chat messages.", "", "ß7State: ßcßlNot using"));
			}
			 if (data.getBoolean(uuid + ".privateMsg")) {
				api.createItem(inv, 12, Material.MAP, 1, "ßbßlPrivate messages", Arrays.asList("ß7If this is in use, you", "ß7wont receive private messages.",
						"", "ß7State: ßaßlUsing"));
			} else if (!data.getBoolean(uuid + ".privateMsg")) {
				api.createItem(inv, 12, Material.MAP, 1, "ßbßlPrivate messages", Arrays.asList("ß7If this is not in use, you", "ß7wont receive private messages.",
						"", "ß7State: ßcßlNot using"));
			}
			 if (data.getBoolean(uuid + ".privateAccount")) {
				api.createItem(inv, 14, Material.NETHER_STAR, 1, "ßbßlPrivate account", Arrays.asList("ß7If this in use, your account will be", "ß7private and nobody can see your stats or profile.",
						"", "ß7State: ßaßlUsing"));
			} else if (!data.getBoolean(uuid + ".privateAccount")) {
				api.createItem(inv, 14, Material.NETHER_STAR, 1, "ßbßlPrivate account", Arrays.asList("ß7If this in use, your account will be", "ß7private and nobody can see your stats or profile.",
						"", "ß7State: ßcßlNot using"));
			}
			
			api.createItem(inv, 27, Material.ARROW, 1, "ßaNormal settings", Arrays.asList("ß7Click to go to the ", "ß7normal settings!"));
			
			p.openInventory(inv);
		}
		
	}
	
	public void openSettingsVIPGUI(Player p){
		
		String uuid = p.getUniqueId().toString();
		KitAPI api = Main.getAPI();
		
		if(Main.getAPI().getLanguage(p.getName()) == Language.FINNISH){
			
			Inventory inv = Bukkit.createInventory(null, 36, "VIP-Asetukset");

			 if (data.getBoolean(uuid + ".privateMsg")) {
				api.createItem(inv, 10, Material.MAP, 1, "ßbßlYksityisviestit", Arrays.asList("ß7Jos t‰m‰ on p‰‰ll‰, et", "ß7saa tulevia yksityisviestej‰!",
						"", "ß7Tila: ßaßlK‰ytˆss‰"));
			} else if (!data.getBoolean(uuid + ".privateMsg")) {
				api.createItem(inv, 10, Material.MAP, 1, "ßbßlYksityisviestit", Arrays.asList("ß7Jos t‰m‰ on p‰‰ll‰, et", "ß7saa tulevia yksityisviestej‰!",
						"", "ß7Tila: ßcßlEi k‰ytˆss‰"));
			}
			 if (data.getBoolean(uuid + ".privateAccount")) {
				api.createItem(inv, 12, Material.NETHER_STAR, 1, "ßbßlYksityinen", Arrays.asList("ß7Jos t‰m‰ on p‰‰ll‰ k‰ytt‰j‰si on", "ß7yksityinen, eik‰ kukaan", 
						"ß7voi n‰hd‰ statsejasi tai profiiliasi", "", "ß7Tila: ßaßlK‰ytˆss‰"));
			} else if (!data.getBoolean(uuid + ".privateAccount")) {
				api.createItem(inv, 12, Material.NETHER_STAR, 1, "ßbßlYksityinen", Arrays.asList("ß7Jos t‰m‰ on p‰‰ll‰ k‰ytt‰j‰si on", "ß7yksityinen, eik‰ kukaan", 
						"ß7voi n‰hd‰ statsejasi tai profiiliasi.", "", "ß7Tila: ßcßlEi k‰ytˆss‰"));
			}
			
			api.createItem(inv, 27, Material.ARROW, 1, "ßaTavalliset asetukset", Arrays.asList("ß7Klikkaa p‰‰st‰ksesi takaisin", "ß7tavallisiin asetuksiin!"));
			
			p.openInventory(inv);
		}
		else if(Main.getAPI().getLanguage(p.getName()) == Language.ENGLISH){
			
			Inventory inv = Bukkit.createInventory(null, 36, "VIP-Settings");
			
			if (data.getBoolean(uuid + ".privateMsg")) {
				api.createItem(inv, 10, Material.MAP, 1, "ßbßlPrivate messages", Arrays.asList("ß7If this is in use, you", "ß7wont receive chat messages.",
						"", "ß7State: ßaßlUsing"));
			} else if (!data.getBoolean(uuid + ".privateMsg")) {
				api.createItem(inv, 10, Material.MAP, 1, "ßbßlBroadcasts", Arrays.asList("ß7If this is not in use, you", "ß7wont receive chat messages.",
						"", "ß7State: ßcßlNot using"));
			}
			 if (data.getBoolean(uuid + ".privateAccount")) {
				api.createItem(inv, 12, Material.NETHER_STAR, 1, "ßbßlPrivate account", Arrays.asList("ß7If this in use, your account will be", "ß7private and nobody can see your stats or profile.",
						"", "ß7State: ßaßlUsing"));
			} else if (!data.getBoolean(uuid + ".privateAccount")) {
				api.createItem(inv, 12, Material.NETHER_STAR, 1, "ßbßlPrivate account", Arrays.asList("ß7If this in use, your account will be", "ß7private and nobody can see your stats or profile.",
						"", "ß7State: ßcßlNot using"));
			}
			
			
			api.createItem(inv, 27, Material.ARROW, 1, "ßaNormal settings", Arrays.asList("ß7Click to go to the ", "ß7normal settings!"));
			
			p.openInventory(inv);
		}
		
	}
	
}
